//@version=5
strategy("SMA 5/20 Crossover with SL/TP & Webhook JSON Alert", overlay=true, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

smaFastLength = input.int(5, title="Fast SMA Period")
smaSlowLength = input.int(20, title="Slow SMA Period")
takeProfitPerc = input.float(2.0, title="Take Profit (%)", minval=0.1)
stopLossPerc = input.float(1.0, title="Stop Loss (%)", minval=0.1)

smaFast = ta.sma(close, smaFastLength)
smaSlow = ta.sma(close, smaSlowLength)

plot(smaFast, title="SMA Fast", color=color.orange)
plot(smaSlow, title="SMA Slow", color=color.blue)

longCondition = ta.crossover(smaFast, smaSlow)
exitCondition = ta.crossunder(smaFast, smaSlow)

longTakeProfit = close * (1 + takeProfitPerc / 100)
longStopLoss = close * (1 - stopLossPerc / 100)

if (longCondition)
    strategy.entry("Buy", strategy.long)
    strategy.exit("TP/SL", from_entry="Buy", limit=longTakeProfit, stop=longStopLoss)
    alert('{"symbol":"{{ticker}}","action":"buy"}', alert.freq_once_per_bar_close)

if (exitCondition)
    strategy.close("Buy")
    alert('{"symbol":"{{ticker}}","action":"sell"}', alert.freq_once_per_bar_close)